# ì¸í•˜ëŒ€í•™êµ í•­ê³µìš°ì£¼ê³µí•™ê³¼ ì„ í˜•ëŒ€ìˆ˜í•™ 2023 ê¸°ë§ê³ ì‚¬ 2ë²ˆ ë¬¸ì œ í’€ì´

date: 2025ë…„ 3ì›” 16ì¼
slug: ase2010_final_exam_2
author: jinwoo im
status: Public
tags: Linear Control
summary: Soft landing of a reusable launcher
ì´ì‚° ì‹œê°„ ì„ í˜• ë™ì  ì‹œìŠ¤í…œì€ ì•„ë˜ì™€ ê°™ì´ ì‹œê°„Â tğ‘¡Â (tâˆˆ{0,â€¦,Nâˆ’1}ğ‘¡âˆˆ{0,â€¦,ğ‘âˆ’1})ì— ë”°ë¥¸ ìƒíƒœ ë²¡í„°Â xtâˆˆRnğ‘¥ğ‘¡âˆˆğ‘…ğ‘›Â ì™€ ì œì–´ ì…ë ¥Â utâˆˆRmğ‘¢ğ‘¡âˆˆğ‘…ğ‘šìœ¼ë¡œ í‘œí˜„í•œë‹¤.xt+1=Axt+Butğ‘¥ğ‘¡+1=ğ´ğ‘¥ğ‘¡+ğµğ‘¢ğ‘¡Ağ´ëŠ” ìƒíƒœ ì²œì´ í–‰ë ¬ì´ë©°,Â BğµëŠ” ì…ë ¥ í–‰ë ¬ì´ë‹¤.Â Ağ´ì™€Â Bğµê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ìš°ë¦¬ì˜ ëª©í‘œëŠ” ì¢…ë§ ì‹œê°„ì— ì›í•˜ëŠ” ìƒíƒœ, ì¦‰Â xN=xdesğ‘¥ğ‘=ğ‘¥desì„ ë§Œì¡±í•˜ëŠ” ìµœì ì˜ ì…ë ¥ ë²¡í„°Â u0,â€¦,uNâˆ’1ğ‘¢0,â€¦,ğ‘¢ğ‘âˆ’1ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤. ìµœì†Œ ì—ë„ˆì§€Â utğ‘¢ğ‘¡ë¥¼ ì°¾ëŠ” ìµœì í™” ë¬¸ì œëŠ” ì•„ë˜ì™€ ê°™ì´ ê¸°ìˆ í•  ìˆ˜ ìˆë‹¤.
type: Post
updatedAt: 2025ë…„ 3ì›” 16ì¼ ì˜¤í›„ 6:48
category: ğŸ“— LinearAlgebra

# 2023 ASE 2010 final exam ë¬¸ì œ í’€ì´

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled.png)

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled%201.png)

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled%202.png)

```python
import numpy as np
import matplotlib.pyplot as plt

N = 200
tf = 20
ts = np.linspace(0,tf,N+1)
dt = tf/N
gamma = .05
g = 9.8

A = np.array([[1, 0, (1-0.5*gamma*dt)*dt,                   0],
              [0, 1,                   0, (1-0.5*gamma*dt)*dt],
              [0, 0,        (1-gamma*dt),                   0],
              [0, 0,                   0,        (1-gamma*dt)]])
B = np.array([[0.5*dt**2,         0],
              [        0, 0.5*dt**2],
              [       dt,         0],
              [        0,        dt]])
b = np.array([0, -0.5*g*dt**2, 0, -g*dt])

x0 = np.array([-200, 2000, 40, -300])
x_des = np.array([0, 0, 0, 0])
```

## ë‚´ í’€ì´

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled%203.png)

ì´ëŸ¬í•œ euclidean normì´ ëª©ì í•¨ìˆ˜(objective funtion)ìœ¼ë¡œ ì •ì˜ë˜ì–´ìˆê³ , ì„ í˜• ë“±ì‹ ì œì•½ì¡°ê±´ì´ ê±¸ë ¤ìˆë‹¤ë©´ ìœ„ì˜ ë¬¸ì œëŠ” ì•„ë˜ì™€ ê°™ì€ ìµœì í™” ë¬¸ì œë¡œ ë‹¤ì‹œ ì •ì˜ëœë‹¤.

$\begin{aligned}
\underset{u}{\text{minimize}} \quad & \sum_{t=0}^{199} \|u_t\|^2  \\
\text{subject to} \quad & \begin{bmatrix}x_{200}\\ x_{150}\end{bmatrix} = \begin{bmatrix}A^{200}\\ A^{150}\end{bmatrix} x_0 + \begin{bmatrix}A^{199}B & A^{198}B & \cdots & AB & B \\ A^{149}B & A^{148}B & \cdots & 0 & 0\end{bmatrix} \begin{bmatrix}u_0 \\u_1 \\ \vdots \\ u_{t-2} \\ u_{t-1}\end{bmatrix} + \begin{bmatrix}A^{199} & A^{198} & \cdots & A & I \\ A^{149} & A^{148} & \cdots & 0 & 0\end{bmatrix}\begin{bmatrix}b \\b \\ \vdots \\ b \\ b\end{bmatrix}
\end{aligned}$

ì´ë•Œ ì£¼ì–´ì§„ ëª©ì í•¨ìˆ˜ë¥¼ minimizeí•˜ëŠ” $u_{des}$ ëŠ” least norm solutionì˜ ê²°ê³¼ë¥¼ í™œìš©í•˜ë©´

$u_{\text{des}} = \left(\begin{bmatrix}A^{199}B & A^{198}B & \cdots & AB & B \\ A^{149}B & A^{148}B & \cdots & 0 & 0\end{bmatrix}\right)^{\dagger} \left( \begin{bmatrix}x_{200}\\ x_{150}\end{bmatrix} - \begin{bmatrix}A^{200}\\ A^{150}\end{bmatrix} x_0 - \begin{bmatrix}A^{199} & A^{198} & \cdots & A & I \\ A^{149} & A^{148} & \cdots & 0 & 0\end{bmatrix}\begin{bmatrix}b \\b \\ \vdots \\ b \\ b\end{bmatrix} \right)$
ì´ë‹¤.

ì´ë•Œ ëª©ì í•¨ìˆ˜ $\sum_{t=0}^{199} \|u_t\|^2  = u_{\text{des}}^T u_{\text{des}}$
  ì´ê³ , $\begin{bmatrix}x_{200}\\ x_{150}\end{bmatrix} = \begin{bmatrix}0\\0\\0\\0\\0\\100\\0\\\lambda\end{bmatrix}$ì´ë‹¤. 

ì´ë•Œ ì£¼ì–´ì§„ ëª©ì í•¨ìˆ˜ëŠ” $\lambda$ ì— ëŒ€í•œ **2ì°¨ ë‹¤í•­ì‹**ì´ ë˜ê³ , **$\lambda$ì— 0,1,2ë¥¼ ëŒ€ì…í•œ í›„, 2ì°¨ ë‹¤í•­ì‹ì„ êµ¬í•œ í›„, 2ì°¨ ë‹¤í•­ì‹ì„ minimizeí•˜ëŠ” $\lambda$**ë¥¼ ì°¾ìœ¼ë©´ ëœë‹¤.

ì£¼ì–´ì§„  $u_{des}$ ë¥¼ ê°„ë‹¨í•˜ê²Œ ì¶•ì•½í•´ë³´ì.

$u_{des} = G^{\dagger} \left(\begin{bmatrix}0\\0\\0\\0\\0\\100\\0\\\lambda\end{bmatrix} -Z\right)$

Gì™€ Zë¥¼ êµ¬í•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
G = np.zeros((8,2*N))

for i in range(N):
  
  G[:4, 2*i:2*(i+1)] = np.linalg.matrix_power(A,max(0,N-i-1))@B
  if i <150:
    G[4:, 2*i:2*(i+1)] =  np.linalg.matrix_power(A,max(0,N-i-51))@B
  else:
    continue

Z = np.zeros(8)
for i in range(N):
  Z[:4] += np.linalg.matrix_power(A,max(0,N-i-1))@b
  if i < 150:
    Z[4:] += np.linalg.matrix_power(A,max(0,N-i-51))@b
  else:
    continue

Z[:4] += np.linalg.matrix_power(A,200)@x0
Z[4:] += np.linalg.matrix_power(A,150)@x0

#psuedo inverse ì •ì˜
psu_G = np.linalg.pinv(G)
```

ì´ë•Œ $\lambda$ì— 0,1,2ë¥¼ ëŒ€ì…í•œ í›„, 2ì°¨ ë‹¤í•­ì‹ì„ êµ¬í•œ í›„, 2ì°¨ ë‹¤í•­ì‹ì„ minimizeí•˜ëŠ” $\lambda$ë¥¼ ì°¾ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```python
X = np.array([0, 0, 0, 0, 0, 100, 0, 0])
lambda_ = np.array([0, 0, 0, 0, 0, 0, 0, 1])

# Normì„ ë‹¤ì‹œ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ ì •ì˜
def norm_equation(lam):
    return np.linalg.norm(psu_G  @ (X + lam * lambda_ - Z))**2

# normì— ê°ê° 0,1,2 ëŒ€ì…
norm_0 = norm_equation(0)
norm_1 = norm_equation(1)
norm_2 = norm_equation(2)

# 2ì°¨ ë°©ì •ì‹ì˜ ê³„ìˆ˜ êµ¬í•˜ê¸°
Q = np.array([
    [0**2, 0, 1],
    [1**2, 1, 1],
    [2**2, 2, 1]
])

c = np.array([norm_0, norm_1, norm_2])
coeff = np.linalg.solve(Q, c)
#ê³„ìˆ˜ê°€ ì–‘ìˆ˜ì¸, xì— ëŒ€í•œ 2ì°¨ ë‹¤í•­ì‹ì„ minimizeí•˜ëŠ” xëŠ” -1*1ì°¨í•­ì˜ê³„ìˆ˜/(2*2ì°¨í•­ì˜ê³„ìˆ˜)ì„ì„ í™œìš©í•œë‹¤.
minimum_y_velocity = -coeff[1]/(2*coeff[0])
print(minimum_y_velocity)
```

 

minimum_y_velocity = 33.11062052290241 ì´ ë‚˜ì™”ë‹¤.

ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Xì™€ uë¥¼ êµ¬í•œ ë‹¤ìŒ ê·¸ë˜í”„ë¡œ ì¶œë ¥í•´ë³´ì.

 

```python
u_des = psu_G@(np.array([0,0,0,0,0,100,0,minimum_y_velocity])-Z)
print(u_des)
u = np.zeros((2,200))
current_x = x0
x = np.zeros((4,201))
x[0][0] = x0[0]
x[1][0] = x0[1]
x[2][0] = x0[2]
x[3][0] = x0[3]
for i in range(N):
  u[0][i],u[1][i] = u_des[2*i],u_des[2*i+1]
  current_x = A@current_x + B@np.array([u[0][i],u[1][i]]) + b

  x[0][i+1] = current_x[0]
  x[1][i+1] = current_x[1]
  x[2][i+1] = current_x[2]
  x[3][i+1] = current_x[3]

draw_plots(ts,x,u)
draw_2d_traj(x,u,150)
```

 

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled%204.png)

ì˜ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

[https://www.youtube.com/shorts/xJeZrzILkXs](https://www.youtube.com/shorts/xJeZrzILkXs)

## í’€ì´ì— ëŒ€í•œ ìƒê°

$\lambda$ ì— ëŒ€í•œ 2ì°¨ ë‹¤í•­ì‹ì„ ë§Œë“œëŠ” ê²ƒì´ ì–´ë ¤ì› ë‹¤â€¦ Normì€ ë¬´ì¡°ê±´ Convexì´ë¯€ë¡œ, local_minimaëŠ” ë¬´ì¡°ê±´ global_minimaê°€ ëœë‹¤. 

ì•„ë§ˆ ê¹€ì¢…í•œ êµìˆ˜ë‹˜ì˜ í’€ì´ëŠ” ì¡°ê¸ˆ ë” ê°„ê²°í•  ê²ƒì´ë‹¤â€¦. ë‚´ê°€ ë„ˆë¬´ ë¬´ì§€í•œ ê²ƒ ê°™ë‹¤.

ë˜í•œ ë™ì  í”„ë¡œê·¸ë˜ë°ì„ ì‚¬ìš©í•˜ì—¬, np.linalg.matrix_powerë¥¼ ë‹¨ìˆœí™” ì‹œì¼œì•¼ í•œë‹¤. 

ì•„ë§ˆ np.linalg.matrix_power ë•Œë¬¸ì—, ì‹œê°„ ë³µì¡ë„ê°€ ìƒë‹¹íˆ ì¦ê°€ë  ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤.

ì´ì— ëŒ€í•´ì„œ ì‹œê°„ì´ ë‚œë‹¤ë©´, ë‹¤ì‹œ í’€ì´ë¥¼ ì‘ì„±í•´ì•¼ê² ë‹¤â€¦.

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%202%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%207f462aa32d6d46e8b7038babd1d96726/Untitled%205.png)