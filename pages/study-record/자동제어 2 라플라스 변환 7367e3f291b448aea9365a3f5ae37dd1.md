# 자동제어 2. 라플라스 변환

date: 2023년 12월 26일
slug: sr-AC002
author: jinwoo im
status: Public
tags: Linear Control
type: Post
updatedAt: 2024년 4월 14일 오후 11:59
category: 🚀 Automatic Control

## 용수철-댐퍼 시스템의 관점

---

우리는 용수철-댐퍼 시스템을 2가지 관점으로 바라 볼 수 있다.

1. 동역학 모델로 만들어진 미분 방정식의 형태
2. 이를 라플라스 변환한 대수 방정식의 형태

### 입력이 0 인 용수철-댐퍼 시스템과 미분 방정식

---

용수철을 당겼다가 놓았다고 해보자.

![Untitled](%EC%9E%90%EB%8F%99%EC%A0%9C%EC%96%B4%202%20%EB%9D%BC%ED%94%8C%EB%9D%BC%EC%8A%A4%20%EB%B3%80%ED%99%98%207367e3f291b448aea9365a3f5ae37dd1/Untitled.png)

이에 대한 미분방정식은 

<aside>
💡 $m\ddot{x} + b\dot{x} + kx = 0$ 로 쓸 수 있다.

 $x=Ce^{\lambda t}$  라 한다면, 

$C(m{\lambda}^2 + b {\lambda}  + k)e^{\lambda t} =  0$ 이다. 

이때 $m{\lambda}^2 + b {\lambda}  + k = 0$  이 된다.  

$λ=\frac{−b±\sqrt{b^2−4mk}}{2m}​​$
 

따라서 $x$ 는 $C e ^ {\frac{−b+\sqrt{b^2−4mk}}{2m} t} + C e ^ {\frac{−b-\sqrt{b^2−4mk}}{2m} t}$ 이다.

</aside>

이렇게 작성해도 동역학을 잘 아는 사람들한테는 충분히 잘 이해되지만, 시스템이 복잡해질 경우 위와 같이 생각하는 것은 쉽지 않다.

또한 이러한 선형미분방정식을 풀기 위해서는 $x=Ce^{\lambda t}$ 라는 가정을 통하여 대입을 통하여 $\lambda$ 를 구하여야 한다. 

### 특성 방정식과 용수철-댐퍼 시스템

---

선형미분방정식은 아래와 같은 표준형으로 표현될 수 있다.

<aside>
💡 $\ddot{x} + 2wζ\dot{x} + w^2 = 0$

이때 $x = Ce^{s t}$ 를 대입하면

$s^2+ 2wζs + w^2 = 0$ 이 된다.

이를 특성방정식이라 한다. 

그러면 $s = -wζ  ± \sqrt{-w^2 +w^2ζ^2}$ 이 된다. 

이때 만약 이차방정식의 판별식이 0 보다 작으면 복소수근이 존재한다.

$D = (2\omega\zeta)^2 - 4\omega^2 = 4\omega^2\zeta^2 - 4\omega^2 =4\omega^2(\zeta^2 - 1)$

만약 $(D < 0)$ 이라면, 이차방정식의 근은 복소수가 된다. 

따라서, 근은 다음과 같이 표현된다.

$s = -\omega\zeta \pm (\omega\sqrt{\zeta^2 - 1})i$

따라서 $x = C_1e^{(-\omega\zeta +(\omega\sqrt{\zeta^2 - 1})i)t} + C_2e^{(-\omega\zeta -(\omega\sqrt{\zeta^2 - 1})i)t}  = e^{-\omega\zeta t}( C_1e^{(\omega\sqrt{\zeta^2 - 1})it} +C_2 e^{(-\omega\sqrt{\zeta^2 - 1})it})$ 로 쪼갤 수 있다. 

</aside>

### 오일러 공식

---

이때 오일러 공식을 알고 있어야 한다.

<aside>
💡 오일러 공식: $e^{i\theta} = cos{\theta} + isin{\theta}$  

이를 활용하면

$e^{i\theta}  + e^{-i\theta} = 2cos{\theta}$

$e^{i\theta}  - e^{-i\theta} = 2isin{\theta}$

</aside>

그러면 $C_1e ^{i\theta}+ C_2e ^{-i\theta} = C_1(cos{\theta} + isin{\theta}) + C_2(cos{(-\theta)} + isin{(-\theta})) \\= C_1(cos{\theta} + isin{\theta}) + C_2(cos{\theta} - isin{\theta}) \\$  이 된다. 

이때 $C_1(cos{\theta} + isin{\theta}) + C_2(cos{\theta} - isin{\theta}) = C_3cos{\theta} + C_4sin{\theta}$  를 만족시키는 $C_4, C_5$ 가 있다고 하면 된다. 

이때 $C_4, C_5$ 는 복소평면에서 해석적으로 구할 수 있다.

그러면 아래와 같이 생각해볼 수 있다.

<aside>
💡 $e^{-\omega\zeta t}( C_1e^{(\omega\sqrt{\zeta^2 - 1})it} +C_2 e^{(-\omega\sqrt{\zeta^2 - 1})it})\\ = e^{-\omega\zeta t}( C_3sin(\omega\sqrt{-\zeta^2 + 1}t)+C_4cos(\omega\sqrt{-\zeta^2 +1}t)\\=Ae^{-\omega\zeta t}sin(\omega\sqrt{-\zeta^2+1}t + φ)$

</aside>

만약 이렇게 미분형으로 표현된 것이 아닌, 대수적으로 문제를 풀 수 있다면 문제를 푸는 것이 쉬워질 것이다.

### 라플라스 변환 개요

---

라플라스 변환은 미분방정식을 대수방정식으로 바꾸어주는 연산이다.

아래와 같이 정의된다.

<aside>
💡 $F(s) = \int_{0}^{\infty} e^{-st} f(t) \, dt$

</aside>

이걸 처음 보면 드는 생각이 있을 것이다.

$e^{-st}$ 를 왜 곱했을까?

![왜 곱했을까???????????](%EC%9E%90%EB%8F%99%EC%A0%9C%EC%96%B4%202%20%EB%9D%BC%ED%94%8C%EB%9D%BC%EC%8A%A4%20%EB%B3%80%ED%99%98%207367e3f291b448aea9365a3f5ae37dd1/Untitled%201.png)

왜 곱했을까???????????

이를 정의하려면 먼저 푸리에 급수와 그걸 사용한 푸리에 변환을 정의한다음, **푸리에 변환의 확장**이 라플라스 변환임을 이해해야 한다.

![아직 잘 모르겠다 ㅠㅠ](%EC%9E%90%EB%8F%99%EC%A0%9C%EC%96%B4%202%20%EB%9D%BC%ED%94%8C%EB%9D%BC%EC%8A%A4%20%EB%B3%80%ED%99%98%207367e3f291b448aea9365a3f5ae37dd1/Untitled%202.png)

아직 잘 모르겠다 ㅠㅠ

## LTI 시스템

---

일단 자동제어에서  라플라스 변환을 사용하려면, 시스템이 LTI(Linear Time Invarient)시스템이어야야 한다.

즉 Linear 하기 때문에 **superposition** 해야 한다

또한 LTI 시스템의 응답은 입력과 임펄스 입력에 대한 시스템의 임펄스응답 과의 **합성곱**(Convolution)이다.

그러면 LTI시스템이 아닌 예시는 무엇일까?

바로 드론이다.

드론은 드론의 자세에 따라서, 드론의 운동방정식이 바뀐다. 직접 해보면 안다.

<aside>
💡 LTI 시스템: 시불변 시스템이라 한다. 즉 이 시스템의 입력값을 알면, **예측을 할 수 있다**는 것이다. 이는 LTI 시스템의 가장 중요한 성질이다.

</aside>

### 합성곱

---

LTI 시스템은 **Linear** 하기 때문에, LTI 시스템의 응답은 Linear combination으로 표현 될 수 있다. 

왜냐하면 Linear function이면 중첩의 원리(superposition)를 사용할 수 있기 때문이다.

이는 김종한 교수님의 **Linear Algebra** 를 보면, 선형 함수는 Superposition이 정의되어야, 선형 함수라 할 수 있다고 했다. 

또한 선형 함수는 Inner Product로 바꿀 수 있고, Inner Product는 선형 함수로 바꿀 수 있다고 했다.

그러면 우리는 LTI 시스템의 출력 $y$ 를 어떤 단위 출력의 Linear Combination으로 표현 할 수 있다는 것을 알 수 있다.

어떤 입력 신호 $x$ 를 생각해보자.

 $y=f(x)$ 라 하고 $y$ 를 선형시스템이라 한다면 입력신호 $x$와 그에 따른 출력신호 $y$ 는 아래와 같이 나타낼 수 있다.

$x = \Delta t a_1 + 2\Delta t a_2 +3\Delta ta_3 ... +  +n\Delta t a_n$

라는 신호가 시스템 $Y$ 에 주어진다면, **중첩의 원리**에 의해 아래와 같이 나타내질 수 있다.

$y = f(\Delta t a_1 + 2\Delta t a_2 +3\Delta ta_3 ... +  +n\Delta t a_n)\\ = a_1​f(Δt)+a_2​f(2Δt)+…+a_n​f(nΔt)$ 

이때 $n→\infin$ 로 보낸다면, 아래와 같이 급수 형태로 나타낼 수 있다.

$x[n] = \sum_{i=1}^{\infty} i\Delta t \cdot a_i$

여기에서 각 $a_i$는 시간 $i$에서의 입력 크기를 나타내고, $\Delta t$는 미소시간 간격이다. 

이제 $h[n]$을 시스템의 임펄스 응답이라고 정의할 수 있다.

임펄스 응답 $h[n]$은 입력이 단위 임펄스 $\delta[n]$일 때의 시스템 응답을 말한다. 

시스템이 선형이므로, 임의의 입력 $x[n]$에 대한 응답은 모든 입력의 임펄스 응답의 Linear Combination으로 표현될 수 있다.

이제 중첩의 원리를 사용하여, 입력 신호 $x[n]$에 대한 출력 $y[n]$을 임펄스 응답을 사용하여 다음과 같이 나타낼 수 있다

$y[n] = \sum_{i=-\infty}^{\infty} x[i] \cdot h[n-i]$

이걸 연속시간으로 변환하면 아래와 같이 정의된다.

$y(t)=∫_{−∞}^{∞}x(τ)h(t−τ)dτ$

이러한 합성곱을 해석학적으로 푸는 것은 인간한테도, 컴퓨터한테도 너무 가혹한 일이다

 

![합성곱을 직접 해석적으로 풀다간 뇌정지가 올 수도 있다.](%EC%9E%90%EB%8F%99%EC%A0%9C%EC%96%B4%202%20%EB%9D%BC%ED%94%8C%EB%9D%BC%EC%8A%A4%20%EB%B3%80%ED%99%98%207367e3f291b448aea9365a3f5ae37dd1/Untitled%203.png)

합성곱을 직접 해석적으로 풀다간 뇌정지가 올 수도 있다.

따라서 합성곱을 아주 쉽게 푸는 방법이 있다.

바로 라플라스 변환이다. 

## 라플라스 변환

---

라플라스 변환의 기초적인 개념은 **0이상의 실수부에서 정의되는 $t$ 공간의 복잡한 미분방정식**을 **복소수 공간인 $s$ 공간**으로 옮겨, 대수 방정식으로 부분분수 분해를 통하여 알려진 형태로 바꾼 후, $s$ 공간을 다시 $t$ 공간으로 바꾸어 일반적인 형태를 얻어내는 것이다.

아까 언급했지만, $f(t)$ 에 대해서 라플라스 변환은 아래와 같이 정의된다.

<aside>
💡 $F(s) = \int_{0}^{\infty} e^{-st} f(t) \, dt$

</aside>

이것만 봐서는 이 식의 위력을 잘 모를 것이다.

라플라스 변환을 통하면 시간공간에서의 복잡한 합성곱 문제를 s 공간에서의 간단한 곱셈 문제로 변환할 수 있다.

t-domain(시간공간)에서의 합성곱은 아래와 같이 정의된다.

<aside>
💡 $y(t)=∫_{−∞}^{∞}x(τ)h(t−τ)dτ$

</aside>

이때 이를 라플라스 변환해보자

<aside>
💡 $Y(s)=∫_0 ^∞e^{−st}[∫_{−∞}^∞x(τ)h(t−τ)dτ]dt$

</aside>

**Fubini의 정리를 적용하면 아래와 같이 된다.**

<aside>
💡 $Y(s)=∫_{−∞}^{∞}x(τ)[∫_0^∞e^{−st}h(t−τ)dt]dτ$

</aside>

이때 **변수를 치환**하여 계산할 수 있다.

$u=t−τ,du=dt$ 라 치환한다면

<aside>
💡 $∫_0^∞e^{−st}h(t−τ)dt=e^{−sτ}∫_{−τ}^{∞}e^{−su}h(u)du$

</aside>

와 같이 바뀐다.

$h(u)$에 라플라스 변환을 적용하고, $τ≥0$에 대해 이동 성질을 적용한다면

<aside>
💡 $∫_{−τ}^{∞}e^{−su}h(u)du=H(s)$

</aside>

<aside>
💡 $Y(s)=∫_{−∞}^{∞}x(τ)e^{−sτ}H(s)dτ=H(s)∫_{−∞}^{∞}x(τ)e^{−sτ}dτ=H(s)X(s)$

</aside>

즉 이를 생각해보면, 합성곱을 $t$ 공간에서 하려면 아주 복잡한 적분 형태의 식을 해석적으로 풀어야 하지만, $s$ 공간에서 한다면, 그냥 곱으로 생각하면 되니 아주 편리하다고 할 수 있다.

## 라플라스 변환과 미분, 그리고 적분

---

## 단위 계단 입력

---

단위 계단입력은 $u(t) =1 (t ≥ 0)$ 이다.  

라플라스 변환 Table 을 보았을 때, $L(e^{-at}) = \frac{1}{s+a}$ 라는 것을 안다. 

그러면 $a = 0$ 일때 $e^{0t}=1$ 이므로, $L(1) = \frac{1}{s}$ 라는 것을 알 수 있다.

## 임펄스 입력

---

단위 계단입력을 미분해보자.

 $u^′(t)$은 라플라스 변환에서 $U(s)$ 에 $s$ 를 곱하면 된다.  

그러면 $U'(s) = s\frac{1}{s} = 1$  이 된다.

## S-Shifting

---

만약 입력 $u(t)$ 가 $u(t) = f(t)e^{-at}$ 라 하자. 

여기에서 주의해야 할 점은 절대 $f(t)$ 와 $e^{-at}$ 사이의 합성곱이 아니다. 

단순한 t-domain에서의 곱일 뿐이다.

이때 특이한 성질이 하나 생기는데

$\mathcal{L}\{e^{-at} f(t)\} = \int_0^\infty e^{-st} e^{-at} f(t) \, dt = \int_0^\infty e^{-(s+a)t} f(t) \, dt = F(s + a)$

놀랍게도, **단순한 지수곱을 했을 뿐인데 대수 방정식의 평행이동**이 되었다.

**또한 이는 반대로, s-domain에서의 대수 방정식의 평행이동을, t-domain에서의 간단한 방정식에 지수가 곱해진것**으로 해석 할 수 있다.

## Final Value Theorem

---

최종값 정리는, $f(t)$ 가 발산하거나 진동하지 않을 때 성립한다.

$\lim_{t \to \infty} f(t) = \lim_{s \to 0} s F(s)$ 이다. 

이에 대한 증명은 다음과 같다.

## Initial Value Theorem

---

## 스프링-시스템에서의 응답, 그리고 전달함수

---

그림과 같은 스프링 시스템을 생각해보자.

그러면 물체의 운동방정식은 아래와 같이 유도된다.

<aside>
💡 $m\ddot{x} + kx = u$

이를 라플라스 변환하면 라플라스 변환의 미분-적분 성질에 의해

$ms^2 X - ms\dot{x(0)}-mx(0) + kX = U(s)$ 가 된다.

이때 초기값이 0이라 가정을 한다면, 이 식은 아래와 같이 쓸 수 있다.

$(ms^2 + k)X = U(s)$

$X = \frac{1}{ms^2 + k}U(s)$

이때 $\frac{1}{ms^2 + k}$ 은 $U(s)$의 전달함수라 정의한다.

이를 라플라스 역변환하면, $sin$ 함수가 나오는 것을 라플라스 Table로부터 유도할 수 있다.

그러면 용수철만 달려있는 시스템은, 계속 진동(오실레이션) 할 것이라는 것을 알 수 있다.

</aside>

## 스프링-댐퍼 시스템에서의 응답

---

그림과 같은 스프링 댐퍼 시스템을 생각해보자.

<aside>
💡 $m\ddot{x} + b\dot{x} + kx = u$

이를 라플라스 변환하면 라플라스 변환의 미분-적분 성질에 의해

$ms^2 X - ms\dot{x(0)}-mx(0)+ bsX - bx(0)+ kX = U(s)$ 가 된다.

이때 초기값이 0이라 가정을 한다면, 이 식은 아래와 같이 쓸 수 있다.

$(ms^2 +bs+ k)X = U(s)$

$X = \frac{1}{ms^2 +bs+ k}U(s)$

이때 $\frac{1}{ms^2 +bs+ k}$ 은 $U(s)$의 전달함수라 정의한다.

이를 라플라스 역변환하면, $sin$ 함수와 $e^{\lambda t}$ 가 곱해져서 것을 라플라스 Table로부터 유도할 수 있다.

그러면 용수철과 댐퍼가 달려있는 시스템은, 계속 진동(오실레이션) 하면서 점차 감쇠할 것이라는 것을 알 수 있다. 

자연계에 용수철 상수와 댐퍼 계수가 0보다 작은 것은 존재하지 않으며, 이러한 성질로부터 용수철 댐퍼 시스템은 감쇠할 것이라는 것을 알 수 있다.

</aside>

## 단위 2차 시스템

---

$X = \frac{1}{ms^2 +bs+ k}U(s)$ 라는 시스템에서 $$m=1, b =  2 k= 인 시스템을 단위 2차 시스템이라 한다.

## Pole 과 Zero

---

## Pole과 Eigenvalue

---

## 분자의 차수, 분모의 차수로부터 알 수 있는 정보

---

만약 전달함수가 스텝입력이라 가정하자.

그러면 $U(s) = \frac{1}{s}$ 이다.

그리고 전달함수 $G(s)$의 분모의 차수가 $n$, 분자의 차수가 $m$ 이라 하자.

출력 $Y(s) = G(s)U(s)$ 이고, $Y(s)$의 분모의 차수는 $n+1$, 분자의 차수는 $m$ 이다.

그러면 Initial Value Theorem을 적용한다면

$\lim_{t \to 0+} y(t) = \lim_{s \to \infty} s Y(s)$ 이고 스텝입력에 대해서 

초기값정리를 생각해본다면 $\lim_{s \to \infty} sG(s)\frac{1}{s} = \lim_{s \to \infty} G(s)$ 이다.

만약 $n=m$ 이라면 초기 응답을 알 수 있다.

하지만 이것보다 더 중요한 사실이 있다.

만약 $n = m+1$이라면 초기의 방향을 알 수 있다는 것이다.

$\dot{y(t)}$ 를 라플라스 변환하면 $sY(s)$ 가 나오고 $sY(s)$에 초기값 정리를 적용해본다면,

$\lim_{s \to \infty} ssG(s)\frac{1}{s} = \lim_{s \to \infty} sG(s)$ 가 나오고, n = m+1 이기 때문에 극한 정리를 적용했을 때, 값이 나올 수 있다.

이걸 보고 초기의 방향을 결정할 수 있다.

![Untitled](%EC%9E%90%EB%8F%99%EC%A0%9C%EC%96%B4%202%20%EB%9D%BC%ED%94%8C%EB%9D%BC%EC%8A%A4%20%EB%B3%80%ED%99%98%207367e3f291b448aea9365a3f5ae37dd1/Untitled%204.png)

이제 이 문제를 어떻게 접근해야 하는지 보일 것이다.

최종값 정리를 적용하여, 위의 스텝입력에 대한 전달함수가 어디로 수렴하는지를 알 수 있고

초기값 정리를 적용하여, 위의 초기 응답의 방향을 알 수 있다.

이를 통해 Undershoot 방향을 결정할 수 있다.

## 임펄스 입력과 미분으로 구성되는 Basis

---