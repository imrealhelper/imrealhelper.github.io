# 인하대학교 항공우주공학과 선형대수학 2023 기말고사 1번 문제 풀이

date: 2024년 1월 8일
slug: ase2010_final_exam_1
author: jinwoo im
status: Public
tags: Linear Control
summary: 2023 항우공 선대 기말고사 1번문제
type: Post
updatedAt: 2025년 3월 16일 오후 6:47
category: 📗 LinearAlgebra

# **2023 ASE 2010 final exam 문제 풀이**

## Node delays in Incheon subway traffic

***(Problem 1)*** 아래의 인천 지하철 노선도를 살펴보자. i번째 역에서 i+1번쨰 역으로 지하철이 이동하는 데 소요되는 시간을 $a_i$라고 하고, i번째 역에서 개찰구와 탑승구 사이를 이동하는데 소요되는 시간을 $b_i$라고 하자. 그렇다면 어떤 k번째 탑승객이 i번째 역에서 j번째 역으로 이동하는 데 소요되는 시간(출발역 개찰구에서 교통카드를 태그한 시간으로부터 도착역 개찰구에서 교통카드를 태그한 시간의 차)은 ($a_i+a_{i+1}+⋯+a_{j−1}$)+$b_i$+$b_j$가 되며 (j>i인 경우), 이 시간은 승객이 출발역과 도착역 개찰구에서 교통카드를 태그한 시간 기록으로부터 측정할 수 있다. (단, 지하철이 도착할 때까지 대기하는 시간과 탑승구가 열리는데 소요되는 시간은 a에 포함된다고 가정한다.)

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%201%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%204e89e48755654d7abd123962c16642fd/Untitled.png)

노선도에 총 n개의 역이 존재할 때, 각 역에서 열차가 출발하여 다음 역에 도착할 때 까지 소요되는 시간을 설명하는 벡터  $a∈R_{n−1}$ 와 각 역의 개찰구로부터 탑승구까지의 이동시간을 설명하는 벡터

$b∈R_{i}$를 정의할 수 있다. 인천교통공사에서 승객 10만명의 교통카드 태그 기록으로부터 승차역 및 하차역, 그리고 지하철 이용시간(승차역-하차역 태그 시간 차이)을 기록하여

```
passenger_data.csv
```

파일에 저장하였다고 가정하자. 이를 이용해 아래 문제를 해결하시오. (단, 위 정의에서 송도달빛축제공원 방면과, 그 반대 방향인 계양 방면으로 이동하는 열차의 속도는 동일하다고 가정하며, 모든 시간 단위는 '분'이다.) (아래 셀을 실행하여 한글 폰트를 설치한 뒤 런타임을 재실행하면 그래프의 x, y 레이블을 한글로 지정할 수 있다.)

***(Problem 1-a)*** 아래의 셀을 실행하면 `passenger_data.csv` 파일을 다운로드할 수 있다. 이를 활용해서, 각 승객이 승차역으로부터 하차역까지 이동하는데 소요된 시간 중, 지하철에 탄 채로 이동하는데 소요된 시간을 $X_a(k,m)a$ 로 표현할 수 있는 행렬 $X_{a}∈R^{K×(n−1)}$와, 개찰구와 탑승구 사이를 이동하는데 소요한 시간을 $X_b(k,m)b$ 로 표현할 수 있는 행렬 $X_{b}∈R^{K×(n)}$을 생성하시오. (Hint: 아래 수식 참조)

- 승객 k가 역 i에서 승차하여 역 j에서 하차한 경우
    - $X_{a}(k,m)=1, for\,m∈{(i,i+1,⋯j−1)}$ (송도달빛축제공원 방면 열차를 탑승한 경우, i<j)
    - $X_{a}(k,m)=1, for\,m∈{(i-1,i-2,⋯j)}$ (송도달빛축제공원 방면 열차를 탑승한 경우, i>j)
    - $X_b(k,i)=X_b(k,j)=1$

이에 대한 **내 풀이**는 다음과 같다. 

### Problem 1-a 풀이

```python
import numpy as np
import pandas as pd

name = { 0:"계양", 1:"귤현", 2:"박촌", 3:"임학", 4:"계산", 5:"경인교대입구", \
            6:"작전", 7:"갈산", 8:"부평구청", 9:"부평시장", 10:"부평", 11:"동수", \
             12:"부평삼거리", 13:"간석오거리", 14:"인천시청", 15:"예술회관", \
             16:"인천터미널", 17:"문학경기장", 18:"선학", 19:"신연수", 20:"원인재", \
             21:"동춘", 22:"동막", 23:"캠퍼스타운", 24:"테크노파크", 25:"지식정보단지", \
             26:"인천대입구", 27:"센트럴파크", 28:"국제업무지구", 29:"송도달빛축제공원" }

inv_name = dict( zip(name.values(), name.keys()) )
data = pd.read_csv( "https://jonghank.github.io/ase2010/files/passenger_data.csv", index_col=0 )
n = len(name)
K = len(data)
X_a = []
X_b  = []
for index, row in data.iterrows():
  L1 = [0 for i in range(n-1)]
  L2 = [1 if i == inv_name[row["탑승"]] or i == inv_name[row["하차"]] else 0 for i in range(n)]
  for i in range(min(inv_name[row["탑승"]],inv_name[row["하차"]]),max(inv_name[row["탑승"]],inv_name[row["하차"]])):
    L1[i] = 1
  X_a.append(L1)
  X_b.append(L2)

X_a = np.array(X_a)
X_b = np.array(X_b)
```

### 

***(Problem 1-b)*** 승차역-하차역 사이의 이동시간 a 와 개찰구-탑승구 이동 소요시간 b의 값을 추산하기 위한 가장 합리적인 방법을 제시하시오. 제시한 방법을 주어진 승하자 기록 데이터에 적용하여 a 와 b를 계산하고 bar graph 형태로 출력하시오.

---

### Problem 1-b

다음과 같은 선형방정식은

$$
y = X_a a + X_b b \\=\begin{bmatrix}X_a, X_b\end{bmatrix} \begin{bmatrix}a\\b\end{bmatrix} 
$$

로 나타낼 수 있다.

Least Squares Solution을 사용하면

$X_{des} = \begin{bmatrix}a\\ b\end{bmatrix} = [[X_a,X_b]^{T}[X_a,X_b]]^{-1}[X_a,X_b]^{T}y$ 

이고 이를 나타내는 코드는 다음과 같다. 

```python
y = np.array(data["소요시간"])

#least square 문제 정의
A = np.hstack([X_a,X_b])
x = np.linalg.lstsq(A,y,rcond = None)[0]
a = x[0:29]
b = x[29:]

# a 값을 출력
station_names =   list(inv_name.keys())
trans_time = []
for i in range(len(station_names)-1):
  trans_time.append(station_names[i] + ":"+station_names[i+1])
fig, ax = plt.subplots(figsize=(15, 8))
index = np.arange(len(trans_time))
bar_width = 0.35
bar2 = ax.bar(index + bar_width, a, bar_width, label='a')
ax.set_xlabel('출발역과 그 다음역')
ax.set_ylabel('값')
ax.set_xticks(index + bar_width / 2)
ax.set_xticklabels(trans_time , rotation=45, ha="right")
ax.legend()
plt.show()

# b값을 출력
fig, ax = plt.subplots(figsize=(15, 8))
index = np.arange(len(station_names))
bar_width = 0.35
bar2 = ax.bar(index + bar_width, b, bar_width, label='b')
ax.set_xlabel('역 이름')
ax.set_ylabel('값')
ax.set_xticks(index + bar_width / 2)
ax.set_xticklabels(station_names, rotation=45, ha="right")
ax.legend()
plt.show()

```

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%201%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%204e89e48755654d7abd123962c16642fd/Untitled%201.png)

![Untitled](%EC%9D%B8%ED%95%98%EB%8C%80%ED%95%99%EA%B5%90%20%ED%95%AD%EA%B3%B5%EC%9A%B0%EC%A3%BC%EA%B3%B5%ED%95%99%EA%B3%BC%20%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%ED%95%99%202023%20%EA%B8%B0%EB%A7%90%EA%B3%A0%EC%82%AC%201%EB%B2%88%20%EB%AC%B8%EC%A0%9C%20%ED%92%80%EC%9D%B4%204e89e48755654d7abd123962c16642fd/Untitled%202.png)

***(Problem 1-c)*** 예술회관 역 근처에 살고 있는 학생이 테크노파크역 항공캠퍼스에서 열리는 10시 30분 수업에 들어오기 위해 지하철을 타려면 적어도 몇시 전에는 예술회관 역에 도착하도록 준비해야 할까? (테크노파크역에서 강의실까지 이동하는 데 5분이 소요된다고 가정하자)

추산한 값의 신뢰성을 RMSE를 이용하여 표현하고 설명하시오.

---

### ***(Problem 1-c)***

```python
total_time = 0
for k in range(i,j):
  total_time+=a[k]

total_time += b[i]
total_time += b[j]

RMSE = 0

for k in val["소요시간"]:
  RMSE += (k-total_time)**2
RMSE = RMSE**(1/2)/len(val)
print(RMSE)
total_time +=5
base_time = datetime.strptime("10:30", "%H:%M")
c = base_time - timedelta(minutes=total_time)
c_plus_b = c + timedelta(minutes=RMSE)
c_minus_b = c - timedelta(minutes=RMSE)
c_plus_b_str = c_plus_b.strftime("%H:%M")
c_minus_b_str = c_minus_b.strftime("%H:%M")
print(c_minus_b_str, c_plus_b_str)
```

09:46에 출발해야 한다는 결과가 나왔다.

a와 b를 이용하여 구한 total_time에 RMSE로 구한 오차 범위를 각각 더하거나 빼, c_plus_b_str과 c_minis_b_str를 구하였다.

그래서 9시 46분에 출발하면 중간에 화장실에 가지 않는 이상 10시 30분에 도착할 수 있다.